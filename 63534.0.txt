@0
S: MOV 0 RIGHT
MOV 999 RIGHT
LOOP:
  MOV UP ACC
 JEZ DONE
  MOV ACC RIGHT
 JMP LOOP
DONE:
 MOV RIGHT ACC
 JEZ S
 MOV ACC RIGHT
 MOV 0 DOWN
 MOV DOWN NIL
 JMP DONE

@1
S: MOV DOWN ACC
SAV
SUB DOWN
JLZ KEEPFIRST
 MOV DOWN DOWN
 JMP S
KEEPFIRST:
 SWP
 MOV DOWN NIL
 MOV ACC DOWN

@2
MOV RIGHT ACC
SAV
L: MOV RIGHT ACC
 JEZ Z
  MOV ACC DOWN
  SWP
  SAV
  SUB DOWN
 JEZ NC
  MOV 1 RIGHT
 JMP L
NC: MOV 2 RIGHT
 SAV
 JMP L
Z: MOV 1 RIGHT

@3
MOV UP RIGHT
  MOV 0 DOWN
L: MOV RIGHT ACC
  JEZ D
  MOV ACC DOWN
  JMP L
D: MOV RIGHT LEFT
DL: MOV DOWN ACC
  MOV ACC LEFT
  JRO LEFT
  MOV ACC RIGHT
  JEZ RST
  JMP DL
RST: MOV 0 UP

@4
MOV LEFT NIL
L:  MOV UP ACC
  MOV ACC LEFT
  MOV ACC RIGHT
  JEZ D
  JMP L
D: MOV 0 UP
MOV RIGHT LEFT
DL: MOV LEFT ACC
  JEZ RST
  MOV ACC UP
  JMP DL
RST:

@5
MOV 999 ACC
L: SAV
 MOV LEFT ACC
 JEZ D
 MOV ACC UP
 SWP
 MOV ACC UP
 MOV ACC UP
 MOV UP ACC
 JMP L
D: SWP
 MOV ACC LEFT
 MOV ACC DOWN

@6
MOV UP UP

@7
MOV RIGHT DOWN

@8
 MOV UP ACC
 SAV
 SUB 999
JEZ OK
 SWP
OK:
 MOV ACC LEFT
